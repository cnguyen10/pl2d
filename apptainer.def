BootStrap: docker
# From: nvidia/cuda:12.6.0-cudnn-runtime-ubuntu22.04
From: nvidia/cuda:12.4.0-base-ubuntu22.04

%environment
    export PATH=/app/venv/bin:$PATH

%post
    apt -y update
    apt -y install python3 python3-pip python3-venv
    python3 -m venv /app/venv

    /app/venv/bin/pip3 install -U "jax[cuda12]"
    /app/venv/bin/pip3 install flax
    /app/venv/bin/pip3 install optax
    /app/venv/bin/pip3 install orbax-checkpoint
    /app/venv/bin/pip3 install jaxopt
    /app/venv/bin/pip3 install tensorflow_probability
    /app/venv/bin/pip3 install hydra-core
    /app/venv/bin/pip3 install mlflow
    /app/venv/bin/pip3 install tqdm
    /app/venv/bin/pip3 install grain
    /app/venv/bin/pip3 install albumentations

%runscript
    /app/venv/bin/python

%help
    Ubuntu 22.04 with Jax